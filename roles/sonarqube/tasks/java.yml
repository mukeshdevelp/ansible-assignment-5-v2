---
# SSH connectivity already verified by ansible ping test, skipping wait_for
# - name: Wait for SSH to be ready
#   wait_for:
#     host: "{{ inventory_hostname }}"
#     port: 22
#     delay: 10
#     timeout: 300

# update caches for ubuntu and debian based systems
- name: Update package cache on Debian/Ubuntu
  apt:
    update_cache: yes
  when: ansible_facts['os_family'] == "Debian"
  
# update caches for redhat based systems
- name: Update package cache on RedHat/CentOS/RHEL
  yum:
    update_cache: yes
  when: ansible_facts['os_family'] == "RedHat"
  
# install java package based on os family independently
- name: Install Java
  package:
    name: "{{ java_pkg }}"
    state: present

- name: Get Java version
  command: java -version
  register: java_version_output
  changed_when: false
  ignore_errors: true

- name: Show Java version
  debug:
    msg: |
      Java version on {{ inventory_hostname }}:
      {{ java_version_output.stderr_lines | default(java_version_output.stdout_lines) }}
